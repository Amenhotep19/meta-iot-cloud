From 3c5d998ca52f2a8c05e7c1f6ec9bb3542f045914 Mon Sep 17 00:00:00 2001
From: Scott Ware <scott.r.ware@intel.com>
Date: Wed, 23 Nov 2016 12:26:09 +0000
Subject: [PATCH 1/2] Skip test dependencies if requested

---
 CMakeLists.txt | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 2e37c1a..d3fe267 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -57,8 +57,6 @@ if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
   set( MEMORYCHECK_COMMAND_OPTIONS "--trace-children=yes --leak-check=full --suppressions=${CMAKE_CURRENT_LIST_DIR}/core/valgrind_suppressions.txt --error-exitcode=1" )
 endif()
 
-include (CTest)
-
 include(CheckSymbolExists)
 function(detect_architecture symbol arch) 
     if (NOT DEFINED ARCHITECTURE OR ARCHITECTURE STREQUAL "")
@@ -149,11 +147,14 @@ macro(compileAsC11)
   endif()
 endmacro(compileAsC11)
 
-enable_testing()
 compileAsC99()
 
 #this adds all test dependencies
-include(dependencies-test.cmake)
+if(NOT ${skip_unittests})
+  enable_testing()
+  include (CTest)
+  include(dependencies-test.cmake)
+endif()
 
 #this adds all dependencies
 include(dependencies.cmake)
-- 
1.9.1

