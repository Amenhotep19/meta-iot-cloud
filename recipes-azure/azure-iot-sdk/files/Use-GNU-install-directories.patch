From 0f60c20b9d81fd3aedf9bfad80191bf4528252fa Mon Sep 17 00:00:00 2001
From: Scott Ware <scott.r.ware@intel.com>
Date: Wed, 16 Nov 2016 11:11:09 +0000
Subject: [PATCH 1/3] Use GNU install directories

---
 c/CMakeLists.txt                       |  3 +++
 c/iothub_client/CMakeLists.txt         |  4 ++--
 c/iothub_service_client/CMakeLists.txt | 10 ++++++++++
 c/serializer/CMakeLists.txt            |  4 ++--
 4 files changed, 17 insertions(+), 4 deletions(-)

diff --git a/c/CMakeLists.txt b/c/CMakeLists.txt
index 513ab12..f513f4a 100644
--- a/c/CMakeLists.txt
+++ b/c/CMakeLists.txt
@@ -13,6 +13,9 @@ if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
     set(MEMORYCHECK_COMMAND_OPTIONS "--trace-children=yes --leak-check=full --error-exitcode=1")
 endif()
 
+# Set CMAKE_INSTALL_* if not defined
+include(GNUInstallDirs)
+
 include (CTest)
 
 if(MSVC)
diff --git a/c/iothub_client/CMakeLists.txt b/c/iothub_client/CMakeLists.txt
index f80486e..99a046e 100644
--- a/c/iothub_client/CMakeLists.txt
+++ b/c/iothub_client/CMakeLists.txt
@@ -263,8 +263,8 @@ if(WIN32)
 else()
     install (TARGETS 
         ${iothub_client_libs} 
-        DESTINATION lib)
+        DESTINATION ${CMAKE_INSTALL_LIBDIR})
     install (FILES 
         ${iothub_client_h_install_files} 
-        DESTINATION include/azureiot)
+        DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/azureiot)
 endif (WIN32)
diff --git a/c/iothub_service_client/CMakeLists.txt b/c/iothub_service_client/CMakeLists.txt
index bd8391c..d2fc91a 100644
--- a/c/iothub_service_client/CMakeLists.txt
+++ b/c/iothub_service_client/CMakeLists.txt
@@ -64,3 +64,13 @@ if(NOT IN_OPENWRT)
 add_subdirectory(tests)
 endif()
 
+if(WIN32)
+else()
+    install (TARGETS 
+        iothub_service_client
+        DESTINATION ${CMAKE_INSTALL_LIBDIR})
+    install (FILES 
+        ${iothub_service_client_h_files} 
+        DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/azureiot)
+endif (WIN32)
+
diff --git a/c/serializer/CMakeLists.txt b/c/serializer/CMakeLists.txt
index b09a826..cd049bc 100644
--- a/c/serializer/CMakeLists.txt
+++ b/c/serializer/CMakeLists.txt
@@ -77,6 +77,6 @@ endif()
 
 if(WIN32)
 else()
-    install (TARGETS serializer DESTINATION lib)
-    install (FILES ${serializer_h_files} DESTINATION include/azureiot)
+    install (TARGETS serializer DESTINATION ${CMAKE_INSTALL_LIBDIR})
+    install (FILES ${serializer_h_files} DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/azureiot)
 endif (WIN32)
-- 
1.9.1

