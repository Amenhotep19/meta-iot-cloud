From 0430d1a95145eb22e84894c1c35b19fcdafbed2b Mon Sep 17 00:00:00 2001
From: Scott Ware <scott.r.ware@intel.com>
Date: Wed, 16 Nov 2016 14:15:30 +0000
Subject: [PATCH 3/3] Skip tests if requested

---
 c/iothub_service_client/CMakeLists.txt            | 2 +-
 c/serializer/CMakeLists.txt                       | 2 +-
 python/device/iothub_client_python/CMakeLists.txt | 5 ++++-
 3 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/c/iothub_service_client/CMakeLists.txt b/c/iothub_service_client/CMakeLists.txt
index bd38c2d..0e20092 100644
--- a/c/iothub_service_client/CMakeLists.txt
+++ b/c/iothub_service_client/CMakeLists.txt
@@ -59,7 +59,7 @@ if (NOT ${ARCHITECTURE} STREQUAL "ARM")
 	add_subdirectory(samples)
 endif()
 
-if(NOT IN_OPENWRT)
+if(NOT IN_OPENWRT AND NOT ${skip_unittests})
 # Disable tests for OpenWRT
 add_subdirectory(tests)
 endif()
diff --git a/c/serializer/CMakeLists.txt b/c/serializer/CMakeLists.txt
index 0f0e636..edb3bea 100644
--- a/c/serializer/CMakeLists.txt
+++ b/c/serializer/CMakeLists.txt
@@ -69,7 +69,7 @@ else()
 	add_subdirectory(samples)
 endif()
 
-if(NOT IN_OPENWRT)
+if(NOT IN_OPENWRT AND NOT ${skip_unittests})
 # Disable tests and samples for OpenWRT
 add_subdirectory(tests)
 endif()
diff --git a/python/device/iothub_client_python/CMakeLists.txt b/python/device/iothub_client_python/CMakeLists.txt
index 75d34a1..cc9e482 100644
--- a/python/device/iothub_client_python/CMakeLists.txt
+++ b/python/device/iothub_client_python/CMakeLists.txt
@@ -76,4 +76,7 @@ if(${use_mqtt})
 endif()
 
 add_subdirectory(src)
-add_subdirectory(test)
+
+if(NOT ${skip_unittests})
+	add_subdirectory(test)
+endif()
-- 
1.9.1

